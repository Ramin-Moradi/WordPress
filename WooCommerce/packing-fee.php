/**
 * اضافه کردن هزینه ثابت بسته‌بندی به سبد خرید ووکامرس
 *
 * این تابع از اکشن 'woocommerce_cart_calculate_fees' استفاده می‌کند تا
 * یک هزینه ثابت را به کل مبلغ سبد خرید اضافه کند.
 *
 * @param WC_Cart $cart نمونه کلاس سبد خرید ووکامرس.
 */
add_action('woocommerce_cart_calculate_fees', 'add_custom_fixed_fee');

function add_custom_fixed_fee(WC_Cart $cart) {
    // بررسی اینکه آیا در محیط مدیریت (Admin) هستیم یا خیر (به جز فراخوانی‌های AJAX)
    if (is_admin() && !defined('DOING_AJAX')) {
        return;
    }

    // --- تنظیمات ---

    // 1. تعیین مبلغ ثابت بسته‌بندی (به عنوان مثال 20000 تومان)
    // توجه: این مبلغ باید بر اساس واحد پولی ووکامرس شما باشد.
    $fixed_fee = 20000;

    // 2. تعریف عنوان هزینه
    $fee_label = __('هزینه بسته‌بندی', 'your-textdomain');

    // --- عملیات افزودن ---

    // افزودن هزینه به سبد خرید. پارامتر سوم (true) به ووکامرس می‌گوید که این هزینه مشمول مالیات است یا خیر.
    // اگر نمی‌خواهید مالیات به آن تعلق بگیرد، آن را false کنید.
    $cart->add_fee($fee_label, $fixed_fee, true);
}
